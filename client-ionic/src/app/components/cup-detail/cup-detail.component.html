<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title text-center>
      Details of Cup: {{ cup.name }}
    </ion-title>
  </ion-toolbar>
  <ion-progress-bar type="indeterminate" *ngIf='!loaded'></ion-progress-bar>
</ion-header>

<ion-content text-center>

  <div *ngIf='loaded'>

    <div padding>
      <table class="table table-bordered">
          <thead>
            <tr>
              <!-- <th class="cup-side-header">
                Name:
              </th> -->
              <th colspan="2" class="cupName">
                <ion-icon name='create' class="edit-button-container text-color" (click)='openCupEditModal()'></ion-icon>
                <ion-icon name='close' class="remove-button-container" (click)='deleteCup()'></ion-icon>
                {{ cup.name }}
              </th>
            </tr>
          </thead>
          <tbody *ngIf="cup.description">
            <tr>
              <td class="cup-side-header">Description:</td>
              <td>{{ cup.description }}</td>
            </tr>
            <!-- <tr>
              <td colspan="2">
                <div class="editButton" (click)='openEditModal()'>EDIT CUP DETAILS</div>
              </td>
            </tr> -->
          </tbody>
        </table>
    </div>

    
    
    <!-- <table class='table table-bordered table-fit'>
      <tr *ngIf='cup.winner'>
        <td>WINNER</td><td><a routerLink='/teams/{{cup.winner._id}}'>{{ cup.winner.name + ' ' + cup.winner.lastname }}</a></td>
      </tr>
      <tr *ngIf='cup.second'>
        <td>SECOND PLACE</td><td><a routerLink='/teams/{{cup.second._id}}'>{{ cup.second.name + ' ' + cup.second.lastname }}</a></td>
      </tr>
      <tr *ngIf='cup.third'>
        <td>THIRD PLACE</td><td><a routerLink='/teams/{{cup.third._id}}'>{{ cup.third.name + ' ' + cup.third.lastname }}</a></td>
      </tr>
    </table> -->

    

    <ion-grid>
      <ion-row>
        <ion-col *ngFor='let group of cup.groups; let groupIndex = index' size-xs='12' size-lg='6'>
          
          <table class='table table-bordered table-striped table-cups' [mfData]="group.teams" mfSortBy="position" mfSortOrder="asc" #mf="mfDataTable">
            <thead>
              <tr class='group-name'>
                <th colspan='3'>
                    <a routerLink='/groups/{{group._id}}'>{{ group.name }}</a>
                    <ion-icon name='close' class="remove-button-container" (click)='removeGroup(group)'></ion-icon>
                </th>
              </tr>
              <tr *ngIf='group.description'>
                <td colspan='3'>
                    {{ group.description }}
                </td>
              </tr>
              <tr>
                <th class="header-sort">
                    <mfDefaultSorter by="position">Position</mfDefaultSorter>
                </th>
                <th class="header-sort">
                    <mfDefaultSorter by="fullName">Name</mfDefaultSorter>
                </th>
                <th class="header-sort">
                    <mfDefaultSorter by="winRatio">Win ratio</mfDefaultSorter>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor='let team of mf.data'>
                <td>{{ team.winRatio ? team.position : '-' }}</td>
                <td>
                  <a routerLink='/teams/{{team._id}}'  class="text">
                  {{ team.fullName }}
                  </a>
                </td>
                <td>{{ team.winRatio ? team.winRatio : '-' }}</td>
              </tr>
              <tr *ngIf='group.teams.length === 0'>
                  <td colspan='3'>There are no teams</td>
                </tr>
              <tr>
                <td colspan='3'>
                  <ion-select placeholder="Select team to add" multiple="true" cancelText="Cancel" okText="OK" 
                  [(ngModel)]='addTeamsSelect[groupIndex]' (ionChange)='changeTeams(group, groupIndex)'  selectedText='Add or remove teams'>
                    <ion-select-option *ngFor='let team of teams; let i = index' value="{{team._id}}">{{ team.name + ' ' + team.lastname }}
                    </ion-select-option>
                  </ion-select>
                </td>
              </tr>
            </tbody>
          </table>

        </ion-col>
      </ion-row>
    </ion-grid>

  </div>

</ion-content>
